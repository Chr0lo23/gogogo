<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Unity WebGL Player | WebglTon</title>
    <link rel="shortcut icon" href="TemplateData/favicon.ico">
    <link rel="stylesheet" href="TemplateData/style.css">
    <link rel="manifest" href="manifest.webmanifest">
  </head>
  <body>
    <div id="unity-container">
      <canvas id="unity-canvas" width=960 height=600 tabindex="-1"></canvas>
      <div id="unity-loading-bar">
        <div id="unity-logo"></div>
        <div id="unity-progress-bar-empty">
          <div id="unity-progress-bar-full"></div>
        </div>
      </div>
      <div id="unity-warning"> </div>
    </div>
    <script src="index.js"></script>
    <script>
        window.addEventListener('load', function() {
            if (window.Telegram.WebApp && window.Telegram.WebApp.initDataUnsafe) {
                const user = window.Telegram.WebApp.initDataUnsafe.user;
                if (user) {
                    const userId = user.id;
                    SendTelegramUserIdToUnity(userId);
                } else {
                    console.error("User data not found.");
                }
            } else {
                console.error("Telegram WebApp not initialized properly.");
            }
        });

        function SendTelegramUserIdToUnity(userId) {
            const unityInstance = unityInstance || window.unityInstance;
            if (unityInstance) {
                unityInstance.SendMessage('GameController', 'OnReceiveUserId', userId.toString());
            } else {
                console.error("Unity instance not found.");
            }
        }
    </script>
  </body>
</html>